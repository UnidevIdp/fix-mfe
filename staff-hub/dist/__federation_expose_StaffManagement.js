"use strict";(self.webpackChunk_common_staff_hub=self.webpackChunk_common_staff_hub||[]).push([["289"],{3387:function(e,t,r){r.r(t),r.d(t,{StaffManagement:()=>h,default:()=>p});var n=r(4076),a=r(587),o=r(427),i=r(433),c=r(4295),f=r(623);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t,r,n,a,o,i){try{var c=e[o](i),f=c.value}catch(e){r(e);return}c.done?t(f):Promise.resolve(f).then(n,a)}function s(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){u(o,n,a,i,c,"next",e)}function c(e){u(o,n,a,i,c,"throw",e)}i(void 0)})}}function d(e,t){var r,n,a,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=c(0),i.throw=c(1),i.return=c(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(f){var l=[c,f];if(r)throw TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(o=0)),o;)try{if(r=1,n&&(a=2&l[0]?n.return:l[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,l[1])).done)return a;switch(n=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){o=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){o.label=l[1];break}if(6===l[0]&&o.label<a[1]){o.label=a[1],a=l;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(l);break}a[2]&&o.ops.pop(),o.trys.pop();continue}l=t.call(e,o)}catch(e){l=[6,e],n=0}finally{r=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var h=function(e){var t,r,u=e.initialViewMode,h=void 0===u?"list":u;try{r=(0,o.UO)().id}catch(e){r=void 0}var p=(0,c.useMfeRouter)("staff-hub"),y=p.navigate,b=p.location,v=p.hasRouter,S=(0,i.useStaff)(),g=S.staff,m=S.loading,w=S.error,k=S.searchQuery,I=S.filters,C=S.selectedStaff,M=S.createStaff,j=S.updateStaff,x=S.deleteStaff,A=S.selectStaff,D=S.setSearchQuery,_=S.setFilters,F=S.refreshStaff,O=(t=(0,a.useState)(function(){return"create"===h?"create":"edit"===h&&r?"edit":r?"detail":"list"}),function(e){if(Array.isArray(e))return e}(t)||function(e,t){var r,n,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var o=[],i=!0,c=!1;try{for(a=a.call(e);!(i=(r=a.next()).done)&&(o.push(r.value),o.length!==t);i=!0);}catch(e){c=!0,n=e}finally{try{i||null==a.return||a.return()}finally{if(c)throw n}}return o}}(t,2)||function(e,t){if(e){if("string"==typeof e)return l(e,2);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),E=O[0],Q=O[1];return(0,a.useEffect)(function(){if(r&&g.length>0){var e=g.find(function(e){return e.id===r});e&&A(e)}},[r,g,A]),(0,a.useEffect)(function(){var e=b.pathname;console.log("Current path:",e,"ID:",r),e.includes("/create")?(console.log("Setting mode to create"),Q("create")):e.includes("/edit")&&r?(console.log("Setting mode to edit for ID:",r),Q("edit")):e.includes("/view")&&r?(console.log("Setting mode to detail for ID:",r),Q("detail")):!r||e.includes("/edit")||e.includes("/view")?(console.log("Setting mode to list"),Q("list")):(console.log("Setting mode to detail (legacy) for ID:",r),Q("detail"))},[b.pathname,r]),(0,n.jsx)(f.StaffManagementDashboard,{staff:g,selectedStaff:C,loading:m,error:w,searchQuery:k,filters:I,onStaffSelect:function(e){A(e),Q("detail"),y("/staff/".concat(e.id,"/view"))},onStaffCreate:function(e){return s(function(){var t;return d(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,M(e)];case 1:return(t=r.sent())&&(Q("detail"),y("/staff/".concat(t.id,"/view"))),[2,t];case 2:return console.error("Failed to create staff:",r.sent()),[2,null];case 3:return[2]}})})()},onStaffUpdate:function(e,t){return s(function(){var r;return d(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,j(e,t)];case 1:return(r=n.sent())&&(Q("detail"),y("/staff/".concat(r.id,"/view"))),[2,r];case 2:return console.error("Failed to update staff:",n.sent()),[2,null];case 3:return[2]}})})()},onStaffDelete:function(e){return s(function(){var t;return d(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,x(e)];case 1:return(t=r.sent())&&(Q("list"),y("/staff")),[2,t];case 2:return console.error("Failed to delete staff:",r.sent()),[2,!1];case 3:return[2]}})})()},onSearch:D,onFilterChange:_,onRefresh:F,initialViewMode:E,onViewModeChange:function(e){if(Q(e),v)switch(e){case"list":y("/staff");break;case"create":y("/staff/create");break;case"edit":C&&y("/staff/".concat(C.id,"/edit"));break;case"detail":C&&y("/staff/".concat(C.id,"/view"))}},className:"w-full"})};let p=h}}]);